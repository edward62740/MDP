/*
 * app_parser.h
 *
 *  Created on: Jan 22, 2024
 *      Author: edward62740
 */

#ifndef INC_APP_PARSER_HP_
#define INC_APP_PARSER_HP_

#include <cmsis_os.h>

#ifdef __cplusplus
extern "C" {
#endif

namespace AppParser {

typedef struct
{
	osThreadId_t runner; // task handle
	osThreadAttr_t attr;
	struct {
		osMessageQueueId_t queue;
		//osMutexId_t lock;
	} mailbox; //

} u_ctx ; // struct containing context info for a  instance.

class Listener
{
public:
	Listener(u_ctx *ctx, uint8_t *buf);
	volatile void invoke();
	~Listener( void );
private:
	u_ctx *ctx;
	uint8_t *buf;
};

class Processor
{
public:
	Processor(u_ctx *ctx);
	void processorTask();
	static void startImpl(void * _this);
	void start();
	~Processor( void );


	u_ctx *ctx;

};

}



#ifdef __cplusplus
}
#endif /* __cplusplus */

#endif /* INC_APP_PARSER_HP_ */
